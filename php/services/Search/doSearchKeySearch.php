<?php	include_once("SearchHelper.php");	include_once("/../../model/Finders/SearchKey.php");	include_once("/../mysql/dbSqlToText.php");	$mainSel = $_GET['main'];	$innerSel = $_GET['in'];	$data = $_GET['data'];	$toMatch= $data;	$mainSel = str_replace(".","", $mainSel);	$innerSel = str_replace(".","", $innerSel);		$id = $modelsHelper[$mainSel];	$theFinder = $modelTags[$id];		$isEvent = false;	if ($id == 4){		$isEvent = true;	}		$gf = new GlobalFinder($theFinder);	$innerSel = $theFinder->getDbName($innerSel);	if (strstr($innerSel, "language")){		//use converter		$data = LanguageToInt($data);	}	else if (strstr($innerSel, "contact")){		$data = ContactToInt($data);	}	else if (strstr($innerSel, "marital")){		$data = MaritalStatusToInt($data);	}	else if (strstr($innerSel, "work")){		$data = WorkStatusToInt($data);	}	else if (strstr($innerSel, "gender")){		$data = GenderToInt($data);	}	else if (strstr($innerSel, "type_id")){		$data = EventTypeToInt($data);	}		$sk = new SearchKey($innerSel, $data);		if ((intval($data)) >0 && !strstr($innerSel, "date")){		$res = $gf->find(array($sk), false);	}	else{		$res = $gf->find(array($sk), true);	}	$toRet = array();		if (!$isEvent){		for ($i=0;$i<sizeof($res);$i++){			$toRet[$i] = $res[$i]->getFamilyId();		}	}else{		for ($i=0;$i<sizeof($res);$i++){			$toRet[$i] = $res[$i]->event_id;		}	}	$subFolder="..\\..\\view\\Components\\";	include_once($subFolder."FileBlock_MainFileBuilder.php");	$subFolder="..\\..\\view\\Components\\";	include_once($subFolder."FileBlock_MainEventBuilder.php");	$subFolder="..\\..\\view\\Components\\";	include_once($subFolder."Gallery.php");	$NumOfFilesFound=sizeof($toRet);		$currIds = array();	for ($i=0;$i<sizeof($toRet);$i++){		if (!in_array($toRet[$i], $currIds)){			$id = $toRet[$i];			array_push($currIds, $id);		}	}	$toRet = $currIds;		$UserIDs = $toRet;	$builder;	if($isEvent){		$builder = new FileBlock_MainEventBuilder();		$ids = $toRet;	}	else{		$ids = $toRet;		$builder = new FileBlock_MainFileBuilder();	}	$Gallery = new Gallery($builder);		$Gallery->doSearch($ids, $toMatch);	$toRet = $Gallery->getContainer()->toHTML();		echo $toRet;?>